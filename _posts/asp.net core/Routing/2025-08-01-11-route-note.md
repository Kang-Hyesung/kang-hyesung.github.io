---
title: "[11] Route μ΄μ •λ¦¬"
date: 2025-08-01 22:04 +0900
author: hyesung
---
ASP.NET Core μ• ν”λ¦¬μΌ€μ΄μ…μ μ‹¬μ¥μ€ **λΌμ°ν…(Routing)** μ— μλ‹¤. λΌμ°ν…μ€ λ“¤μ–΄μ¤λ” HTTP μ”μ²­μ„ λ¶„μ„ν•μ—¬ μ–΄λ–¤ μ½”λ“(Controller Action, Razor Page, Minimal API ν•Έλ“¤λ¬ λ“±)κ°€ μ²λ¦¬ν•΄μ•Ό ν• μ§€ κ²°μ •ν•λ” ν•µμ‹¬ λ©”μ»¤λ‹μ¦μ΄λ‹¤. μ μ„¤κ³„λ λΌμ°ν…μ€ μ• ν”λ¦¬μΌ€μ΄μ…μ URLμ„ κΉ”λ”ν•κ³  μλ―Έ μκ² λ§λ“¤μ–΄μ£Όλ©°, μ΄λ” APIμ μ§κ΄€μ„±κ³Ό μ‚¬μ©μ„±μ„ λ†’μ΄λ” λ° κ²°μ •μ μΈ μ—­ν• μ„ ν•λ‹¤. π›£οΈ

μ΄ κΈ€μ—μ„λ” ASP.NET Core λΌμ°ν…μ λ™μ‘ μ›λ¦¬λ¶€ν„° μ‹μ‘ν•μ—¬, λΌμ°νΈ νλΌλ―Έν„°, μ μ•½ μ΅°κ±΄, κ·Έλ¦¬κ³  μ°μ„ μμ„ κ²°μ • μ•κ³ λ¦¬μ¦κΉμ§€ κΉμ΄ μκ² μ•μ•„λ³Έλ‹¤.

### 1. λΌμ°ν…μ ν•µμ‹¬ μ›λ¦¬: `UseRouting`κ³Ό `UseEndpoints`

ASP.NET Coreμ λΌμ°ν…μ€ λ‘ κ°μ ν•µμ‹¬ λ―Έλ“¤μ›¨μ–΄(Middleware)μ— μν•΄ λ‘ λ‹¨κ³„λ΅ μ²λ¦¬λλ‹¤.

1. **`UseRouting()`**: μ”μ²­ λ§¤μΉ­(Route Matching) λ‹¨κ³„. λ“¤μ–΄μ¤λ” μ”μ²­μ URLκ³Ό HTTP λ©”μ„λ“λ¥Ό λ¶„μ„ν•μ—¬ λ“±λ΅λ μ—”λ“ν¬μΈνΈ(Endpoint) λ©λ΅κ³Ό λΉ„κµν•κ³ , κ°€μ¥ μ ν•©ν• μ—”λ“ν¬μΈνΈλ¥Ό μ°Ύμ•„λ‚Έλ‹¤. μ΄ λ―Έλ“¤μ›¨μ–΄λ” μ°Ύμ€ λΌμ°ν… μ •λ³΄λ¥Ό `HttpContext`μ— μ¶”κ°€ν•λ‹¤.
2. **`UseEndpoints()`**: μ—”λ“ν¬μΈνΈ μ‹¤ν–‰(Endpoint Execution) λ‹¨κ³„. `UseRouting`μ΄ μ°Ύμ•„λ‚Έ μ—”λ“ν¬μΈνΈμ— μ—°κ²°λ μ‹¤μ  μ½”λ“λ¥Ό μ‹¤ν–‰ν•λ‹¤.
    

μ΄ λ‘ λ―Έλ“¤μ›¨μ–΄λ” λ°λ“μ‹ **`UseRouting()`μ΄ λ¨Όμ € νΈμ¶λμ–΄μ•Ό ν•λ‹¤**λ” μ μ΄ μ¤‘μ”ν•λ‹¤. λ§¤μΉ­μ΄ λ¨Όμ € μ΄λ£¨μ–΄μ Έμ•Ό μ‹¤ν–‰ν•  λ€μƒμ„ μ• μ μκΈ° λ•λ¬Έμ΄λ‹¤.

```csharp
var app = builder.Build();

// 1. λΌμ°ν… λ―Έλ“¤μ›¨μ–΄λ¥Ό ν™μ„±ν™”ν•μ—¬ μ”μ²­μ„ λ¶„μ„ν•κ³  λ§¤μΉ­ν•  μ¤€λΉ„λ¥Ό ν•λ‹¤.
app.UseRouting();

// 2. λ§¤μΉ­λ μ—”λ“ν¬μΈνΈλ¥Ό μ‹¤ν–‰ν•λ‹¤.
app.UseEndpoints(endpoints =>
{
    // μ—”λ“ν¬μΈνΈ(λΌμ°νΈ) μ •μλ” μ΄ μ•μ—μ„ μ΄λ£¨μ–΄μ§„λ‹¤.
    endpoints.MapGet("/home", async context => {
        await context.Response.WriteAsync("Welcome Home!");
    });
});

// λ§¤μΉ­λλ” μ—”λ“ν¬μΈνΈκ°€ μ—†μ„ κ²½μ° μ‹¤ν–‰λ  ν΄λ°±(fallback) λ―Έλ“¤μ›¨μ–΄
app.Run(async context => {
    await context.Response.WriteAsync($"No route matched for {context.Request.Path}");
});

app.Run();
```

_μ°Έκ³ : Minimal API μ¤νƒ€μΌ(`.NET 6` μ΄μƒ)μ—μ„λ” `app.MapGet()` λ“±μ„ μ§μ ‘ νΈμ¶ν•λ©΄ λ‚΄λ¶€μ μΌλ΅ `UseRouting`κ³Ό `UseEndpoints`κ°€ μλ™μΌλ΅ κ΄€λ¦¬λμ–΄ μ½”λ“κ°€ λ” κ°„κ²°ν•΄μ§„λ‹¤._

---

### 2. λ™μ  URL μ²λ¦¬: λΌμ°νΈ νλΌλ―Έν„° (Route Parameters)

μ •μ μΈ URLλ§μΌλ΅λ” λ³µμ΅ν• μ• ν”λ¦¬μΌ€μ΄μ…μ„ λ§λ“¤κΈ° μ–΄λ µλ‹¤. λΌμ°νΈ νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•λ©΄ URLμ μΌλ¶€λ¥Ό λ³€μλ΅ λ°›μ•„ λ™μ μΌλ΅ μ²λ¦¬ν•  μ μλ‹¤.

- **ν•„μ νλΌλ―Έν„° `{parameter}`**: URLμ— λ°λ“μ‹ ν¬ν•¨λμ–΄μ•Ό ν•λ” κ°’μ΄λ‹¤.
    
    - `files/{filename}.{extension}`: `filename`κ³Ό `extension`μ΄ λ¨λ‘ μμ–΄μ•Ό λ§¤μΉ­λλ‹¤.
        
- **μ„ νƒμ  νλΌλ―Έν„° `{parameter?}`**: URLμ— κ°’μ΄ μ—†μ–΄λ„ λ§¤μΉ­λλ‹¤. μ½”λ“μ—μ„λ” `null`λ΅ μ „λ‹¬λλ‹¤.
    
    - `products/details/{id?}`: `id` κ°’μ΄ μ—†μ–΄λ„ λ§¤μΉ­λλ‹¤.
        
- **κΈ°λ³Έκ°’ νλΌλ―Έν„° `{parameter=defaultValue}`**: URLμ— κ°’μ΄ μ—†μΌλ©΄ μ§€μ •λ κΈ°λ³Έκ°’μ„ μ‚¬μ©ν•λ‹¤.
    
    - `employee/profile/{EmployeeName=guest}`: `EmployeeName` κ°’μ΄ μ—†μΌλ©΄ "guest"κ°€ μ‚¬μ©λλ‹¤.
        

#### μ½”λ“ μμ‹

```csharp
app.UseEndpoints(endpoints =>
{
    // ν•„μ νλΌλ―Έν„° μμ‹
    endpoints.Map("files/{filename}.{extension}", async context =>
    {
        string? fileName = context.Request.RouteValues["filename"]?.ToString();
        string? extension = context.Request.RouteValues["extension"]?.ToString();
        await context.Response.WriteAsync($"File: {fileName}.{extension}");
    });

    // κΈ°λ³Έκ°’ νλΌλ―Έν„° μμ‹
    endpoints.Map("employee/profile/{EmployeeName=guest}", async context =>
    {
        string? employeeName = context.Request.RouteValues["employeename"]?.ToString();
        await context.Response.WriteAsync($"Profile for {employeeName}");
    });

    // μ„ νƒμ  νλΌλ―Έν„° μμ‹
    endpoints.Map("products/details/{id?}", async context => 
    {
        if (context.Request.RouteValues.TryGetValue("id", out var idValue))
        {
            await context.Response.WriteAsync($"Product Details for ID: {idValue}");
        }
        else
        {
            await context.Response.WriteAsync("Product ID was not provided.");
        }
    });
});
```

νλΌλ―Έν„° κ°’μ€ `context.Request.RouteValues` λ”•μ…”λ„λ¦¬λ¥Ό ν†µν•΄ μ΅°νν•  μ μλ‹¤.

---

### 3. μ”μ²­ ν•„ν„°λ§: λΌμ°νΈ μ μ•½ μ΅°κ±΄ (Route Constraints)

λΌμ°νΈ μ μ•½ μ΅°κ±΄μ„ μ‚¬μ©ν•λ©΄ νλΌλ―Έν„°κ°€ νΉμ • κ·μΉ™μ„ λ”°λ¥Ό λ•λ§ λΌμ°νΈκ°€ λ§¤μΉ­λλ„λ΅ ν•  μ μλ‹¤. μ΄λ” λ¶ν•„μ”ν• μ”μ²­μ„ ν•Έλ“¤λ¬ λ‹¨κ³„ μ΄μ „μ— κ±Έλ¬λ‚΄κ³  μ½”λ“λ¥Ό κΉ¨λ—ν•κ² μ μ§€ν•λ” λ° λ§¤μ° μ μ©ν•λ‹¤.

- **μ‚¬μ©λ²•**: `{parameter:constraint}` ν•μ‹μΌλ΅ μ¶”κ°€ν•λ‹¤.
    
- **μ£Όμ” λ‚΄μ¥ μ μ•½ μ΅°κ±΄**:
    
    - `int`, `bool`, `double`, `guid`: νΉμ • λ°μ΄ν„° νƒ€μ…μ΄μ–΄μ•Ό ν•λ‹¤.
    - `alpha`: μλ¬Έμλ§ ν—μ©ν•λ‹¤.
    - `length(min, max)`: λ¬Έμμ—΄ κΈΈμ΄λ¥Ό μ ν•ν•λ‹¤.
    - `range(min, max)`: μ«μ λ²”μ„λ¥Ό μ ν•ν•λ‹¤.
    - `regex(pattern)`: μ •κ· ν‘ν„μ‹ ν¨ν„΄κ³Ό μΌμΉν•΄μ•Ό ν•λ‹¤.
        

#### μ½”λ“ μμ‹

```csharp
app.UseEndpoints(endpoints =>
{
    // idλ” 1μ—μ„ 1000 μ‚¬μ΄μ μ •μμ—¬μ•Ό ν•λ©°, μ„ νƒμ μ΄λ‹¤.
    endpoints.Map("products/details/{id:int:range(1,1000)?}", async context => {
        // ...
    });

    // yearλ” 1900 μ΄μƒμ μ •μμ—¬μ•Ό ν•κ³ , monthλ” μ§€μ •λ λ¶„κΈ° μ¤‘ ν•λ‚μ—¬μ•Ό ν•λ‹¤.
    endpoints.Map("sales-report/{year:int:min(1900)}/{month:regex(^(apr|jul|oct|jan)$)}", async context =>
    {
        // ...
    });

    // cityidλ” λ°λ“μ‹ GUID ν•νƒμ—¬μ•Ό ν•λ‹¤.
    endpoints.Map("cities/{cityid:guid}", async context =>
    {
        // ...
    });
});
```

---

### 4. κ³ κΈ‰ κΈ°μ : μ»¤μ¤ν…€ μ μ•½ μ΅°κ±΄κ³Ό `GetEndpoint`

#### μ»¤μ¤ν…€ λΌμ°νΈ μ μ•½ μ΅°κ±΄ λ§λ“¤κΈ°

λ‚΄μ¥ μ μ•½ μ΅°κ±΄μΌλ΅ λ¶€μ΅±ν•  κ²½μ°, `IRouteConstraint` μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν•μ—¬ μμ‹ λ§μ μ μ•½ μ΅°κ±΄μ„ λ§λ“¤ μ μλ‹¤.

1. `IRouteConstraint`λ¥Ό κµ¬ν„ν•λ” ν΄λμ¤λ¥Ό λ§λ“ λ‹¤.
2. `Match` λ©”μ„λ“ μ•μ— μ›ν•λ” μ ν¨μ„± κ²€μ‚¬ λ΅μ§μ„ μ‘μ„±ν•λ‹¤.

```csharp
// νΉμ • μ›”(λ¶„κΈ° μ‹μ‘ μ›”)λ§ ν—μ©ν•λ” μ»¤μ¤ν…€ μ μ•½ μ΅°κ±΄
public class MonthsCustomConstraint : IRouteConstraint
{
    public bool Match(HttpContext? httpContext, IRouter? route, string routeKey, RouteValueDictionary values, RouteDirection routeDirection)
    {
        if (!values.ContainsKey(routeKey)) return false;

        string? monthValue = values[routeKey]?.ToString();
        var regex = new Regex("^(apr|jul|oct|jan)$", RegexOptions.IgnoreCase);

        return monthValue != null && regex.IsMatch(monthValue);
    }
}
```

μ‚¬μ©λ²•:

Program.csμ—μ„ μ μ•½ μ΅°κ±΄μ„ μ„λΉ„μ¤μ— λ“±λ΅ν• ν›„ {month:months} μ™€ κ°™μ΄ μ‚¬μ©ν•λ‹¤.

```csharp
// Program.cs
builder.Services.AddRouting(options => {
    options.ConstraintMap.Add("months", typeof(MonthsCustomConstraint));
});

// ...

// μ—”λ“ν¬μΈνΈ μ •μ
endpoints.Map("sales-report/{year:int:min(1900)}/{month:months}", ...);
```

#### μ‹¤ν–‰ μ¤‘μΈ μ—”λ“ν¬μΈνΈ μ •λ³΄ ν™•μΈν•κΈ° (`GetEndpoint`)

λ―Έλ“¤μ›¨μ–΄μ—μ„ ν„μ¬ μ”μ²­μ΄ μ–΄λ–¤ μ—”λ“ν¬μΈνΈμ— λ§¤μΉ­λμ—λ”μ§€ ν™•μΈν•΄μ•Ό ν•  λ•κ°€ μλ‹¤. μ΄λ• `context.GetEndpoint()` λ©”μ„λ“λ¥Ό μ‚¬μ©ν•λ‹¤. μ΄ λ©”μ„λ“λ” **`UseRouting()` λ―Έλ“¤μ›¨μ–΄ μ‹¤ν–‰ μ΄ν›„**μ—λ§ μ ν¨ν• κ°’μ„ λ°ν™ν•λ‹¤.

```csharp
// UseRouting() μ΄μ „μ— μ‹¤ν–‰λλ” λ―Έλ“¤μ›¨μ–΄
app.Use(async (context, next) => 
{
    // μ΄ μ‹μ μ—μ„λ” GetEndpoint()κ°€ ν•­μƒ nullμ„ λ°ν™ν•λ‹¤.
    Endpoint? endPoint = context.GetEndpoint();
    Console.WriteLine($"Before Routing - Endpoint: {endPoint?.DisplayName ?? "null"}");
    await next(context);
});

app.UseRouting();

// UseRouting() μ΄ν›„μ— μ‹¤ν–‰λλ” λ―Έλ“¤μ›¨μ–΄
app.Use(async (context, next) =>
{
    // μ΄ μ‹μ μ—μ„λ” λ§¤μΉ­λ μ—”λ“ν¬μΈνΈ μ •λ³΄λ¥Ό κ°€μ Έμ¬ μ μλ‹¤.
    Endpoint? endPoint = context.GetEndpoint();
    Console.WriteLine($"After Routing - Endpoint: {endPoint?.DisplayName ?? "null"}");
    await next(context);
});
```

---

### 5. λΌμ°ν…μ μ°μ„ μμ„: μ—”λ“ν¬μΈνΈ μ„ νƒ μ•κ³ λ¦¬μ¦

λ§μ•½ ν•λ‚μ μ”μ²­μ΄ μ—¬λ¬ μ—”λ“ν¬μΈνΈμ— λ§¤μΉ­λ  μ μλ‹¤λ©΄? ASP.NET Coreλ” λ‹¤μ μμ„μ— λ”°λΌ κ°€μ¥ μ ν•©ν• μ—”λ“ν¬μΈνΈλ¥Ό μ„ νƒν•λ‹¤.

1. **λ” κµ¬μ²΄μ μΈ λΌμ°νΈκ°€ μ°μ„ **: `/products/{id}`λ” `/products`λ³΄λ‹¤ κµ¬μ²΄μ μ΄λ―€λ΅ λ¨Όμ € μ„ νƒλλ‹¤.
2. **λ” λ§μ€ μ μ•½ μ΅°κ±΄μ„ κ°€μ§„ λΌμ°νΈκ°€ μ°μ„ **: `{id:int}`λ” `{id}`λ³΄λ‹¤ λ” κµ¬μ²΄μ μ΄λ―€λ΅ μ°μ„ ν•λ‹¤.
3. **μ„ μ΅°κ±΄μ΄ λ™μΌν•λ©΄ λ¨Όμ € λ“±λ΅λ λΌμ°νΈκ°€ μ°μ„ **: μ½”λ“μƒ μ„μ— μ‘μ„±λ λΌμ°νΈκ°€ μ„ νƒλλ‹¤.

λ§μ•½ μ‹μ¤ν…μ΄ λ…ν™•ν•κ² ν•λ‚μ μ—”λ“ν¬μΈνΈλ¥Ό κ²°μ •ν•  μ μ—†λ‹¤λ©΄ `AmbiguousMatchException` μμ™Έκ°€ λ°μƒν•λ‹¤.

---

### Java Springμ—μ„λ”?

C#μ ASP.NET Core λΌμ°ν… κ°λ…μ€ Javaμ Spring Bootμ™€ λ§¤μ° μ μ‚¬ν•κ² λ§¤ν•‘λλ‹¤.

- **μ—”λ“ν¬μΈνΈ μ •μ (`Map*` β†” `@RestController`, `@GetMapping`)**:
    
    - **ASP.NET Core**: `app.MapGet("/api/products", ...)`
    - **Spring Boot**: `@RestController` ν΄λμ¤ λ‚΄λ¶€μ— `@GetMapping("/api/products")` μ–΄λ…Έν…μ΄μ…μ„ λ¶™μΈ λ©”μ„λ“λ¥Ό μ‚¬μ©ν•λ‹¤.
        
    
    ```java
    @RestController
    public class ProductController {
        @GetMapping("/api/products")
        public List<Product> getAllProducts() {
            // ... λ΅μ§
        }
    }
    ```
    
- **λΌμ°νΈ νλΌλ―Έν„° (`RouteValues` β†” `@PathVariable`)**:
    
    - **ASP.NET Core**: `files/{filename}`
    - **Spring Boot**: `@GetMapping("/files/{filename}")`κ³Ό κ°™μ΄ μ •μν•κ³ , λ©”μ„λ“ νλΌλ―Έν„°μ— `@PathVariable`μ„ μ‚¬μ©ν•μ—¬ κ°’μ„ λ°›λ”λ‹¤.
        
    ```java
    @GetMapping("/products/{id}")
    public Product getProductById(@PathVariable int id) {
        // id λ³€μλ¥Ό μ§μ ‘ μ‚¬μ©
    }
    ```
    
- **λΌμ°νΈ μ μ•½ μ΅°κ±΄ (`:int` β†” νƒ€μ… μ§€μ •, `regex`)**:
    
    - **ASP.NET Core**: `{id:int}`
    - **Spring Boot**: `@PathVariable int id` μ™€ κ°™μ΄ νλΌλ―Έν„° νƒ€μ…μ„ μ§€μ •ν•λ” κ²ƒ μμ²΄κ°€ κ°•λ ¥ν• μ μ•½ μ΅°κ±΄ μ—­ν• μ„ ν•λ‹¤. μ •κ· ν‘ν„μ‹ μ μ•½μ€ `@GetMapping` μ–΄λ…Έν…μ΄μ… μ•μ— μ§μ ‘ μ¶”κ°€ν•  μ μλ‹¤. (`@GetMapping("/sales/{month:apr|jul|oct}")`)

μ΄μ²λΌ ν”„λ μ„μ›ν¬λ§λ‹¤ λ¬Έλ²•μ€ λ‹¤λ¥΄μ§€λ§, 'μ”μ²­μ„ νΉμ • ν•Έλ“¤λ¬μ™€ μ—°κ²°ν•λ‹¤'λ” λΌμ°ν…μ κ·Όλ³Έμ μΈ μ² ν•™μ€ λ™μΌν•λ‹¤.

